**Enhanced Block Lists for Restricting Risky Processes and Modules in Windows Defender Application Guard/Device Guard**

Microsoft produces (at https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules) a list of Microsoft-produced executables (most built into Windows 10, some not but downloadable from MS) that it recommends you block if you're trying to create a robust application control policy with WDAC/DG because they can be abused to bypass restrictions and run arbitrary code. This list is fine as far as it goes (though no doubt there are other bypasses waiting to either be discovered or be made public), but it's definitely a bit on the conservative side in terms of blocking potential bypass hazards. Moreover, it doesn't really address any other important purposes of using block rules in WDAC/DG. Like preventing certain processes from loading specific dlls, add-ins, etc. that likely would only be used by those processes during malicious activity. After the release of new WDAC/DG capabilities in Windows 10 1703 and subsequent forced retirement of EMET on Windows 10, the only way to restrict what modules can be loaded by what processes on Windows 10 today is to create WDAC block rules that do so. 

My aim here is to gradually publish a collection of improved block rulesets that use selective blocking of both processes and modules (largely dlls) to both guard against actual "bypass" techniques and restrict code execution mechanisms that may not technically count as hard bypasses but are abusable by real-world actors to evade application control and other defenses. (Or just overwhelmingly abused for malicious purposes in general.) These rulesets, just like the ruleset Microsoft produces, are designed to be merged into other policies (for eg., one of the starter policies included with Win 10 Enterprise, or a policy you create by scanning a reference machine with Powershell scripts as described in the MS documentation at https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-initial-default-policy ), not to be compiled and put into force on their own. 

Some notes on the particular contents of the policies will be included in the sub-folders that contain them. 

**Note #1:** Unfortunately, as of this writing you still need a machine or VM running Windows 10 Enterprise to use the Powershell scripts that merge and compile WDAC/DG policies.  Likewise, while you can always edit by hand the xml file of a sample/starter policy or even create your own from ground up, if you’d like to use the auto scanning & creation Powershell scripts MS has created you’ll currently need an install of Enterprise to do so.  (Fortunately, you do have the ability to do a VM or dual-boot trial of Win 10 Enterprise for up to 180 days before Windows starts complaining about software validation.)

**Note #2:** Also as of this writing, the "Disable:Script Enforcement" option that is documented in the official MS guidance does not actually work. The import of that is that putting *any* WDAC/DG policy into place and enforcing it will result in Powershell, WSH, etc. running in Constrained Language Mode. Even if you just want to selectively block certain module loads into certain processes that are usually initiated maliciously, as the old EMET Attack Surface Reduction capabilities allowed you to do. CLM being enforced may not be a dealkiller for you; indeed, for the large majority of general use PC setups it’s probably desirable. But if it is a dealkiller... well, as of now that means you have no usable successor to EMET ASR rules on Windows 10.  As with the Enterprise policy creation restrictions, this is lousy. But for now it is what it is. (Going on to the Windows Feedback Hub and politely bugging MS to get this important setting working probably couldn't do any harm, though.)
   
